### 文档说明

- 本文档用于安装K8S集群
- 描述了K8S集群部署的两种方式：单master部署、多master部署（高可用K8S集群）

### 安装目标

- 离线搭建k8s集群
- 使用k8s对gpu进行调度

### K8S架构图

![Kubernetes Architect.png](Kubernetes%20Architect.png)

### 单master集群与多master集群拓扑图

![img.png](img.png)

### 单master集群部署

- 详细安装见`single-master-k8s-install`

#### 单master安装涉及到的服务器及配置明细（参考）

| 主机名     | IP地址         | CPU核数 | 内存大小 | 系统盘  | 数据盘   | 系统版本     | 用途说明                |
|---------|--------------|-------|------|------|-------|----------|---------------------|
| master1 | 55.192.0.125 | 2     | 8GB  | 40GB | 500GB | RHEL 8.9 | K8s 控制节点            |
| node1   | 55.192.0.7   | 2     | 8GB  | 40GB | 500GB | RHEL 8.9 | K8s 工作节点            |
| node2   | 55.192.0.159 | 2     | 8GB  | 40GB | 500GB | RHEL 8.9 | K8s 工作节点            |
| gpu1    | 55.192.0.225 | 16    | 64GB | 40GB | 500GB | RHEL 8.9 | GPU 工作节点,已安装完成GPU驱动 |

### 多master集群部署

- 详细安装见`multi-master-k8s-install`

#### 多master安装涉及到的服务器及配置明细（参考）

- master节点至少3个，建议为奇数
- 多master集群需要准备一个负载均衡器，这里我们使用keepalived + haproxy临时来搭建高可用负载均衡器
    - 为了节省服务器资源，此处使用master1和master2来搭建负载均衡器

| 主机名     | IP地址         | CPU核数 | 内存大小 | 系统盘  | 数据盘   | 系统版本     | 用途说明                |
|---------|--------------|-------|------|------|-------|----------|---------------------|
| master1 | 55.192.0.125 | 2     | 8GB  | 40GB | 500GB | RHEL 8.9 | K8s 控制节点            |
| master2 | 55.192.0.7   | 2     | 8GB  | 40GB | 500GB | RHEL 8.9 | K8s 控制节点            |
| master3 | 55.192.0.159 | 2     | 8GB  | 40GB | 500GB | RHEL 8.9 | K8s 控制节点            |
| gpu1    | 55.192.0.225 | 16    | 64GB | 40GB | 500GB | RHEL 8.9 | GPU 工作节点，已安装完成GPU驱动 |
| --      | 55.192.0.1   | --    | --   | --   | --    | --       | 虚拟IP，负载均衡的虚拟IP地址    |





